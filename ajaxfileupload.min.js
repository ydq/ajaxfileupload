$.extend({createUploadIframe:function(a){var b="jUploadFrame"+a;return $("<iframe>").attr({id:b,name:b}).css({top:"-9999px",left:"-9999px",position:"absolute"}).appendTo("body")[0]},createUploadForm:function(a,b){var c="jUploadForm"+a,d="jUploadFile"+a,e=$("#"+b),f=$(e).clone();return $("<form>").attr({id:c,name:c}).append($(e).attr("id",d).before(f)).css({position:"absolute",top:"-1200px",left:"-1200px"}).appendTo("body")[0]},addOtherRequestsToForm:function(a,b){var d,c=$('<input type="hidden"/>');for(d in b)c.clone().attr({name:d,value:b[d]}).appendTo(a);return a},ajaxFileUpload:function(a){var b,d,e,f,g,h,i;a=$.extend({},$.ajaxSettings,a),b=(new Date).getTime(),$.createUploadIframe(b),d=$.createUploadForm(b,a.fileElementId),e="jUploadFrame"+b,f="jUploadForm"+b,g=!1,h={},a.data&&(d=$.addOtherRequestsToForm(d,a.data)),a.global&&!$.active++&&$.event.trigger("ajaxStart"),a.global&&$.event.trigger("ajaxSend",[h,a]),i=function(b){var f,j,k,c=$("#"+e)[0];try{f=c.contentWindow||c.contentDocument,f&&(h.responseText=f.document.body?f.document.body.innerHTML:null,h.responseXML=f.document.XMLDocument?f.document.XMLDocument:f.document)}catch(i){$.handleError(a,h,null,i)}if(h||"timeout"==b){g=!0;try{j="timeout"!=b?"success":"error","error"!=j?(k=$.uploadHttpData(h,a.dataType),a.success&&a.success(k,j),a.global&&$.event.trigger("ajaxSuccess",[h,a])):$.handleError(a,h,j)}catch(i){j="error",$.handleError(a,h,j,i)}a.global&&$.event.trigger("ajaxComplete",[h,a]),a.global&&!--$.active&&$.event.trigger("ajaxStop"),a.complete&&a.complete(h,j),$(c).off(),setTimeout(function(){try{$(c,d).remove()}catch(b){$.handleError(a,h,null,b)}},100),h=null}},a.timeout>0&&setTimeout(function(){g||i("timeout")},a.timeout);try{$("#"+f).attr({action:a.url,method:"POST",target:e,encoding:"multipart/form-data",enctype:"multipart/form-data"}).submit()}catch(j){$.handleError(a,h,null,j)}return $("#"+e).on("load",i),{abort:function(){}}},uploadHttpData:function(a,b){var d,e,c=!b;return c="xml"==b||c?a.responseXML:a.responseText,"script"==b&&$.globalEval(c),"json"==b&&(d=/<pre.*?>(.*?)<\/pre>/i,d.test(c)&&(e=d.exec(c),c=e?e[1]:""),c=JSON.parse(c)),"html"==b&&$("<div>").html(c).evalScripts(),c},handleError:function(a,b,c,d){a.error&&a.error.call(a.context||a,b,c,d),a.global&&(a.context?$(a.context):$.event).trigger("ajaxError",[b,a,d])}});